# S-DES 加密系统开发手册

## 项目概述
本系统基于 S-DES 算法，使用 C++/QT 语言开发加密模块，使用 Python 语言开发解密模块。系统支持用户图形界面（GUI）交互，通过加密和解密功能保障数据安全。

## 1. 系统架构
系统主要由两个部分组成：
- **加密模块**（C++/QT）
- **解密模块**（Python）

## 2. 开发手册

### 2.1 接口定义

#### 2.1.1 C++/QT 加密模块

##### 2.1.1.1 函数：

- **描述**：实现 S-DES 加密和解密的核心类。

1. **on_pushButton_clicked()**
   - **功能**：处理用户点击按钮后的操作。
   - **流程**：
     - 获取明文和密钥。
     - 验证输入的二进制格式和长度。
     - 若是 ASCII 字符串，自动转换成二进制进行分块加密。
     - 调用 `encrypt` 函数执行加密，最后输出结果。

2. **encrypt(const QString &plaintext, const QString &key)**
   - **功能**：执行加密操作。
   - **步骤**：
     - 生成两个 8 位密钥 k1 和 k2。
     - 执行初始置换，进行两轮加密运算。
     - 返回最终的密文。

3. **keyGeneration(const QString &key)**
   - **功能**：根据 10 位密钥生成两个 8 位的密钥。
   - **步骤**：
     - 执行 P10 置换。
     - 左移操作生成 K1 和 K2。
     - 执行 P8 置换得到最终密钥。

4. **applyInitialPermutation(const QString &input)**
   - **功能**：进行初始置换操作。

5. **fFunction(const QString &right, const QString &key)**
   - **功能**：执行轮函数，包含扩展、异或、S-Box 替换和 P-Box 置换。

6. **sBoxSubstitution(const QString &input)**
   - **功能**：进行 S-Box 替换。

7. **toBinary(const QString& input)**
   - **功能**：将 ASCII 字符串转换为二进制字符串。

8. **toAsciiString(const QString &binary)**
   - **功能**：将二进制字符串转换回 ASCII 字符串。

9. **isBinaryString(const QString& str)**
   - **功能**：判断输入的字符串是否为有效的二进制字符串（仅包含 0 和 1）。

10. **binaryToDecimal(const QString &binary, bool *ok)**
    - **功能**：将二进制字符串转换为十进制整数。

**注意事项**：
- 输入验证：确保用户输入的明文和密钥长度符合要求，否则程序会显示提示信息。
- 只读输出：加密后的结果在输出框中为只读状态，用户无法修改。
- 错误处理：在转换和加密过程中，若出现输入格式错误或其他异常，程序会提示用户并终止操作。

#### 2.1.2 Python 解密模块

##### 2.1.2.1 函数：`sdes_encrypt`

- **`def sdes_encrypt(plaintext, key):`**
  - **描述**：对输入的明文进行 S-DES 加密。
  - **参数**：
    - `plaintext`: 8-bit 的明文字符串。
    - `key`: 10-bit 的密钥字符串。
  - **返回值**：加密后的密文字符串（8-bit）。

##### 2.1.2.2 函数：`sdes_decrypt`

- **`def sdes_decrypt(ciphertext, key):`**
  - **描述**：对输入的密文进行 S-DES 解密。
  - **参数**：
    - `ciphertext`: 8-bit 的密文字符串。
    - `key`: 10-bit 的密钥字符串。
  - **返回值**：解密后的明文字符串（8-bit）。

### 2.2 常量定义

- **P10**: (3, 5, 2, 7, 4, 10, 1, 9, 8, 6)
- **P8**: (6, 3, 7, 4, 8, 5, 10, 9)
- **IP**: (2, 6, 3, 1, 4, 8, 5, 7)
- **IP-inverse**: (4, 1, 3, 5, 7, 2, 8, 6)
- **EPBox**: (4, 1, 2, 3, 2, 3, 4, 1)
- **SBox1**: [[1, 0, 3, 2], [3, 2, 1, 0], [0, 2, 1, 3], [3, 1, 0, 2]]
- **SBox2**: [[0, 1, 2, 3], [2, 3, 1, 0], [3, 0, 1, 2], [2, 1, 0, 3]]

### 2.3 GUI 设计

- **界面元素**：
  - 输入框：用于输入明文和密钥。
  - 加密按钮：触发加密操作，显示结果。
  - 解密按钮：触发解密操作，显示结果。
  - 输出框：显示加密或解密后的结果。

## 3. 依赖环境

- **C++/QT**: 确保安装了 QT 开发环境。
- **Python**: 确保安装了 Python 及所需库（如 `numpy` 或其他）。

## 4. 测试

- 为每个方法编写单元测试，确保加密和解密过程符合 S-DES 算法的要求。
- 测试边界条件，如最小和最大输入。

## 5. 参考文献

- S-DES 算法相关文献及文档。
- C++/QT 开发文档。
- Python 编程指南。
